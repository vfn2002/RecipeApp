<!--
  Generated template for the RecipePage page.

  See http://ionicframework.com/docs/components/#navigation for more info on
  Ionic pages and navigation.
-->
<!-- <ion-header>

  <ion-navbar>
    <ion-title>{{(recipe$ | async).label}}</ion-title>
  </ion-navbar>

</ion-header> -->


<ion-content>

  <div class="full-screen-content flex-middle" *ngIf="!(recipe$ | async)">
    <ion-spinner></ion-spinner>
  </div>

  <div class="recipe-content" *ngIf="(recipe$ | async)">
    <div [style.background]="'url(' + (recipe$ | async).image + ')'" class="recipe-header-image">

      <div class="back-button-container" (click)="navigateBack()">
        <ion-icon class="back-arrow" name="arrow-back"></ion-icon>
      </div>

      <div class="timer-container" *ngIf="(recipe$ | async).totalTime > 0">
        <span class="timer-label-chip">
          {{(recipe$ | async).totalTime}} mins
        </span>
      </div>

      <div class="diet-chips-container">
        <span class="diet-chips" *ngFor="let dietLabel of (recipe$ | async).dietLabels">
            {{dietLabel}}
        </span>
      </div>
    </div>

    <!-- <button class="full-recipe-button" ion-button>Instructions and full recipe</button> -->

    <h1 class="recipe-title">{{(recipe$ | async).label}}</h1>
    <div class="macros-container">
      <ion-chip class="yield-macros">
          <ion-label>
            {{(recipe$ | async).digest[0].total / (recipe$ | async).yield | number:'1.0-0'}} {{(recipe$ | async).digest[0].unit}} {{(recipe$ | async).digest[0].label}}
          </ion-label>
      </ion-chip>
      <ion-chip class="yield-macros">
        <ion-label>
          {{(recipe$ | async).digest[1].total / (recipe$ | async).yield  | number:'1.0-0'}} {{(recipe$ | async).digest[1].unit}} {{(recipe$ | async).digest[1].label}}
        </ion-label>
      </ion-chip>
      <ion-chip class="yield-macros">
        <ion-label>
          {{(recipe$ | async).digest[2].total / (recipe$ | async).yield  | number:'1.0-0'}} {{(recipe$ | async).digest[2].unit}} {{(recipe$ | async).digest[2].label}}
        </ion-label>
      </ion-chip>
    </div>
    <div class="calories-container">
      <ion-chip class="yield-macros">
        <ion-label>
          {{((recipe$ | async).calories / (recipe$ | async).yield) | number:'1.0-0'}} kcal
        </ion-label>
      </ion-chip>
    </div>

    <ion-card>
      <ion-card-content>
        <ion-card-title>
            Ingredients
        </ion-card-title>
        <p>Yield: {{(recipe$ | async).yield}}</p>
        <ion-list>
          <ion-item *ngFor="let ingredientLine of (recipe$ | async).ingredientLines" text-wrap>{{ingredientLine}}</ion-item>
        </ion-list>
        <button ion-button class="add-to-shopping-button" (click)="addIngredientsToShoppingList()">Add to shopping list</button>
      </ion-card-content>
    </ion-card>

    <p class="source-text">Source: {{(recipe$ | async).source}}</p>
    <button ion-button icon-end color="primary" class="full-recipe-button" (click)="openSourceUrl()">
      Full recipe & instructions
      <ion-icon name="exit"></ion-icon>
    </button>

  </div>

</ion-content>
